\section{Zadanie 3}
Przygotowujemy odpowiedŸ skokow¹ toru wejœcie-wyjœcie tzn. zestaw liczb $s_1,s_2,...$ oraz odpowiedŸ skokow¹ toru zak³ócenie-wyjœcie tzn. zestaw liczb $s_1^z,s_2^z,...$ wykorzystywane w algorytmie DMC (odpowiedŸ na skok jednostkowy w chwili $k = 0$). Dokonujemy poni¿szych operacji na wektorach pobranych odpowiedzi skokowych obiektu.
\begin{equation}
s_i = \frac{y_i- Y_{\mathrm{pp}}}{\Delta U}, dla\ i=1,...
\end{equation}
\begin{equation}
s_i^z = \frac{y_i- Y_{\mathrm{pp}}}{\Delta Z}, dla\ i=1,...
\end{equation}
Wykorzystano odpowiedŸ skokow¹ przy zmianie wartoœci $G1$ z 35 na 37 oraz odpowiedŸ skokow¹ przy zmianie wartoœci $Z$ z 0 na 30. Odpowiedzi skokowe zaproksymowano u¿ywaj¹c cz³onu inercyjnego drugiego rzêdu z opóŸnieniem. Zastosowano optymalizacjê – wyznaczenie takich wartoœci parametrów $T_1$, $T_2$, $K$, $T_{\mathrm{d}}$, aby wartoœæ funkcji celu (wartoœæ b³êdu dopasowania) by³a jak najmniejsza.
\begin{equation}
min\ E=\sum_{k=1}^{k_{\mathrm{max}}}(s(k)-y_{aproks}(k))^{2}
\end{equation}

Przyjêto nastêpuj¹ce ograniczenia parametrów:
\begin{equation}
		0,001 \ll T_1 \ll 1000
\end{equation}
\begin{equation}
		0,001 \ll T_2 \ll 1000
\end{equation}
\begin{equation}
		-10 \ll K \ll 10
\end{equation}
\begin{equation}
		0 \ll T_{\mathrm{d}} \ll 500
\end{equation}

Optymalizacji dokonano wykorzystuj¹c funkcjê \verb+fmincon+, która znajduje minimum funkcji z uwzglêdnieniem ograniczeñ. Jedynymi ograniczeniami s¹ te, narzucone na argumenty wywo³ania funkcji celu, czyli na wy¿ej okreœlone parametry. Kryteria zatrzymania algorytmu pozostawiono domyœlne. Podsumowuj¹c, wynik algorytmu otrzymano przez zastosowanie polecenia: 
\begin{lstlisting}
[optim_params, E] = fmincon(fun, x0, [],[],[],[], lb, ub);
\end{lstlisting}
gdzie:
\begin{lstlisting}
optim_params – szukane parametry
E – b³¹d dopasowania
fun – funkcja zwracaj¹ca wartoœæ b³êdu dopasowania
x0 – wektor parametrów pocz¹tkowych
lb – wektor dolnych ograniczeñ
ub – wektor górnych ograniczeñ
\end{lstlisting}
Wyznaczone parametry - tor sterowanie-wyjœcie:
$T_1 = \num{251,2387}, T_2 = \num{0,072366}, K = \num{0,48671}, T_{\mathrm{d}} = 6, E = \num{2,0984}$.
Wyznaczone parametry - tor zak³ócenie-wyjœcie:
$T_1 = \num{89,0529}, T_2 = \num{2,1074}, K = \num{0,15435}, T_{\mathrm{d}} = 9, E = \num{0,0030778}$.

\begin{figure}[H]
\centering
\includegraphics[scale=1]{rysunki/odp_sk_u}
\caption{OdpowiedŸ skokowa toru wejœcie-wyjœcie wykorzystywana w algorytmie DMC}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[scale=1]{rysunki/odp_sk_z}
\caption{OdpowiedŸ skokowa toru zak³ócenie-wyjœcie wykorzystywana w algorytmie DMC}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[scale=1]{rysunki/porownanie}
\caption{Porównanie oryginalnej odpowiedzi skokowej  toru wejœcie-wyjœcie z aproksymowan¹}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[scale=1]{rysunki/aprox_z}
\caption{Porównanie oryginalnej odpowiedzi skokowej toru zak³ócenie-wyjœcie z aproksymowan¹}
\end{figure}
